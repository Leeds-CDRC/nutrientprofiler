<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Handling input data • nutrientprofiler</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Handling input data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nutrientprofiler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/nutrientprofiler.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/custom_specific_gravity.html">Custom specific gravity</a></li>
    <li><a class="dropdown-item" href="../articles/handling_input_data.html">Handling input data</a></li>
    <li><a class="dropdown-item" href="../articles/nutrientprofile_assessment.html">Nutrient Profile Model Assessment</a></li>
    <li><a class="dropdown-item" href="../articles/nutrientprofile_scoring.html">Nutrient Profile Model Scoring</a></li>
    <li><a class="dropdown-item" href="../articles/parameter_guide.html">Parameter guide</a></li>
    <li><a class="dropdown-item" href="../articles/preprocessing.html">Preprocessing input data</a></li>
    <li><a class="dropdown-item" href="../articles/specific_gravity.html">Specific Gravity Adjustment</a></li>
    <li><a class="dropdown-item" href="../articles/workflows.html">Example HPC workflow and troubleshooting</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Leeds-CDRC/nutrientprofiler/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Handling input data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Leeds-CDRC/nutrientprofiler/blob/main/vignettes/handling_input_data.Rmd" class="external-link"><code>vignettes/handling_input_data.Rmd</code></a></small>
      <div class="d-none name"><code>handling_input_data.Rmd</code></div>
    </div>

    
    
<p>Input data is likely to be messy and to not contain the required
column names for <code>nutrientprofiler</code>. This vignette provides
some advice and guidelines on how to pre-process your data to allow
analysis and assessment with <code>nutrientprofiler</code>.</p>
<p>You can see what parameters are expected in more detail in the <a href="../articles/parameter_guide.html">Parameter guide
documentation</a> or the <a href="../reference/cdrcdrinks.html">Example
dataset reference</a>. The order of parameters/columns in the loaded
data do not matter.</p>
<div class="section level2">
<h2 id="loading-an-example-template">Loading an example template<a class="anchor" aria-label="anchor" href="#loading-an-example-template"></a>
</h2>
<p>When possible, it is a good idea to ensure your data is in the
required format before yourload it in to R. This can be achieved by
using a template.</p>
<p>The <code>nutrientprofiler</code> package offers an example dataset,
<code>cdrcdrinks</code>. This can be saved out as an example csv file
and then edited and loaded with real data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save an example csv file to your current working directory</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">cdrcdrinks</span>, <span class="st">"template_full.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, just the headers can be saved, providing a blank csv
file which can be opened in Excel or your editor of choice:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save an example csv file to your current working directory</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cdrcdrinks</span><span class="op">)</span><span class="op">)</span>, <span class="st">"template_headings.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="checking-column-names-and-renaming-parameters">Checking column names and renaming parameters<a class="anchor" aria-label="anchor" href="#checking-column-names-and-renaming-parameters"></a>
</h2>
<p>If raw data has been acquired with different column names than
required, a reproducible workflow can be set up to rename these
parameters as required.</p>
<p>The first step is to check the existing column names:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inputDataCheck.html">inputDataCheck</a></span><span class="op">(</span><span class="va">cdrcdrinks</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "All required column names found. Proceed with analysis."</span></span></code></pre></div>
<p>If the dataframe contains names as expected, you’ll get a message
telling you to proceed with analysis, as with the example dataset
above.</p>
<p>However, lets say we have loaded in a dataset from csv
<code>irregular_data</code> that does not contain the exact columns
required:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inputDataCheck.html">inputDataCheck</a></span><span class="op">(</span><span class="va">irregular_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The provided dataframe is missing the following required column names:"</span></span>
<span><span class="co">#&gt; [1] "fvn_measurement_percent"</span></span>
<span><span class="co">#&gt; [1] "The provided dataframe contains these unmatched columns names:"</span></span>
<span><span class="co">#&gt; [1] "fruit_nutrition_percent"</span></span>
<span><span class="co">#&gt; [1] "irregular_data &lt;- parameterRename(missing_column_name = 'fvn_measurement_percent', associated_data_column = '&lt;INSERT DATA COLUMN NAME HERE&gt;', data_frame = irregular_data)"</span></span></code></pre></div>
<p>This provides you with the name of the column(s) that do not match an
expected column name (<code>"fruit_nutrition_percent"</code> in this
example), and provides you with a prompt to use the
<code><a href="../reference/parameterRename.html">parameterRename()</a></code> function.</p>
<p>You can copy this hint and replace
<code>&lt;INSERT DATA COLUMN NAME HERE&gt;</code> with the data that
matches the listed <code>missing_column_name</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">irregular_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parameterRename.html">parameterRename</a></span><span class="op">(</span>missing_column_name <span class="op">=</span> <span class="st">'fvn_measurement_percent'</span>, associated_data_column <span class="op">=</span> <span class="st">'fruit_nutrition_percent'</span>, data_frame <span class="op">=</span> <span class="va">irregular_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Replacing fruit_nutrition_percent with fvn_measurement_percent"</span></span></code></pre></div>
<p>You can now check again if the required parameters are available.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inputDataCheck.html">inputDataCheck</a></span><span class="op">(</span><span class="va">irregular_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "All required column names found. Proceed with analysis."</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="missing-parameters">Missing parameters<a class="anchor" aria-label="anchor" href="#missing-parameters"></a>
</h2>
<p>Some of the parameters are optional, but still need an allocated
column in the input data table. This column can be simply filled with
<code>NA</code> values. <code>nutrientprofiler</code> provides some
simple functions to help achieve this quickly.</p>
<p>You can see if we run the <code>inputDataCheck</code> there are no
returns for “unmatched columns”, suggesting that the data is missing as
opposed to unlabelled:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inputDataCheck.html">inputDataCheck</a></span><span class="op">(</span><span class="va">missing_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The provided dataframe is missing the following required column names:"</span></span>
<span><span class="co">#&gt; [1] "brand"            "product_category"</span></span>
<span><span class="co">#&gt; [1] "The provided dataframe contains these unmatched columns names:"</span></span>
<span><span class="co">#&gt; character(0)</span></span>
<span><span class="co">#&gt; [1] "missing_data &lt;- parameterRename(missing_column_name = 'brand', associated_data_column = '&lt;INSERT DATA COLUMN NAME HERE&gt;', data_frame = missing_data)"           </span></span>
<span><span class="co">#&gt; [2] "missing_data &lt;- parameterRename(missing_column_name = 'product_category', associated_data_column = '&lt;INSERT DATA COLUMN NAME HERE&gt;', data_frame = missing_data)"</span></span></code></pre></div>
<p>We can store the list of missing parameters by using the
<code>listMissingParameters</code> function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">missing_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/listMissingParameters.html">listMissingParameters</a></span><span class="op">(</span><span class="va">missing_data</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">missing_params</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "brand"            "product_category"</span></span></code></pre></div>
<p>If we are happy that these are optional parameters that can be filled
with <code>NA</code> values, we can pass this list (or a subset of it)
to the <code>fillMissingParameters</code> function:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filled_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fillMissingParameters.html">fillMissingParameters</a></span><span class="op">(</span><span class="va">missing_data</span>, <span class="va">missing_params</span><span class="op">)</span></span>
<span></span>
<span><span class="va">filled_data</span></span>
<span><span class="co">#&gt;                  name product_type food_type drink_format</span></span>
<span><span class="co">#&gt; 1              lembas         Food                       </span></span>
<span><span class="co">#&gt; 2     zeno's icecream         Food Ice cream             </span></span>
<span><span class="co">#&gt; 3         mystic rush        Drink                  Ready</span></span>
<span><span class="co">#&gt; 4  delta ringer drink        Drink               Powdered</span></span>
<span><span class="co">#&gt; 5        welter water        Drink                Cordial</span></span>
<span><span class="co">#&gt; 6       janus's drink         Food                       </span></span>
<span><span class="co">#&gt; 7   beta ringer drink        Drink               Powdered</span></span>
<span><span class="co">#&gt; 8   zeta ringer drink        Drink               Powdered</span></span>
<span><span class="co">#&gt; 9   heavyweight water        Drink                Cordial</span></span>
<span><span class="co">#&gt; 10       bantam water        Drink                Cordial</span></span>
<span><span class="co">#&gt;                drink_type                     nutrition_info</span></span>
<span><span class="co">#&gt; 1                                                           </span></span>
<span><span class="co">#&gt; 2                                                           </span></span>
<span><span class="co">#&gt; 3  Carbonated/juice drink                                   </span></span>
<span><span class="co">#&gt; 4                             Preparation instructions given</span></span>
<span><span class="co">#&gt; 5                                                As consumed</span></span>
<span><span class="co">#&gt; 6                                                           </span></span>
<span><span class="co">#&gt; 7                                                As consumed</span></span>
<span><span class="co">#&gt; 8                         Preparation instructions not given</span></span>
<span><span class="co">#&gt; 9                             Preparation instructions given</span></span>
<span><span class="co">#&gt; 10                        Preparation instructions not given</span></span>
<span><span class="co">#&gt;    energy_measurement_kj energy_measurement_kcal sugar_measurement_g</span></span>
<span><span class="co">#&gt; 1                    266                      NA                  50</span></span>
<span><span class="co">#&gt; 2                     NA                      24                  21</span></span>
<span><span class="co">#&gt; 3                     NA                     194                  11</span></span>
<span><span class="co">#&gt; 4                    188                      NA                  15</span></span>
<span><span class="co">#&gt; 5                     NA                     205                  19</span></span>
<span><span class="co">#&gt; 6                     NA                      24                  21</span></span>
<span><span class="co">#&gt; 7                    188                      NA                  15</span></span>
<span><span class="co">#&gt; 8                    188                      NA                  15</span></span>
<span><span class="co">#&gt; 9                     NA                     205                  19</span></span>
<span><span class="co">#&gt; 10                    NA                     205                  19</span></span>
<span><span class="co">#&gt;    satfat_measurement_g salt_measurement_g sodium_measurement_mg</span></span>
<span><span class="co">#&gt; 1                     3                 NA                   0.6</span></span>
<span><span class="co">#&gt; 2                    11               0.08                    NA</span></span>
<span><span class="co">#&gt; 3                     0                 NA                 100.0</span></span>
<span><span class="co">#&gt; 4                     0                 NA                 100.0</span></span>
<span><span class="co">#&gt; 5                     0               0.10                    NA</span></span>
<span><span class="co">#&gt; 6                    11               0.08                    NA</span></span>
<span><span class="co">#&gt; 7                     0                 NA                 100.0</span></span>
<span><span class="co">#&gt; 8                     0                 NA                 100.0</span></span>
<span><span class="co">#&gt; 9                     0               0.10                    NA</span></span>
<span><span class="co">#&gt; 10                    0               0.10                    NA</span></span>
<span><span class="co">#&gt;    fibre_measurement_nsp fibre_measurement_aoac protein_measurement_g</span></span>
<span><span class="co">#&gt; 1                      3                     NA                   7.0</span></span>
<span><span class="co">#&gt; 2                     NA                    0.7                   3.5</span></span>
<span><span class="co">#&gt; 3                     NA                    0.0                   0.0</span></span>
<span><span class="co">#&gt; 4                     NA                    0.0                   0.5</span></span>
<span><span class="co">#&gt; 5                     NA                    0.0                   0.1</span></span>
<span><span class="co">#&gt; 6                     NA                    0.7                   3.5</span></span>
<span><span class="co">#&gt; 7                     NA                    0.0                   0.5</span></span>
<span><span class="co">#&gt; 8                     NA                    0.0                   0.5</span></span>
<span><span class="co">#&gt; 9                     NA                    0.0                   0.1</span></span>
<span><span class="co">#&gt; 10                    NA                    0.0                   0.1</span></span>
<span><span class="co">#&gt;    fvn_measurement_percent weight_g volume_ml volume_water_ml brand</span></span>
<span><span class="co">#&gt; 1                        0      100        NA              NA    NA</span></span>
<span><span class="co">#&gt; 2                        0       NA       100              NA    NA</span></span>
<span><span class="co">#&gt; 3                        0       NA       100              NA    NA</span></span>
<span><span class="co">#&gt; 4                        3       25        NA             100    NA</span></span>
<span><span class="co">#&gt; 5                        6       NA       100              NA    NA</span></span>
<span><span class="co">#&gt; 6                        0       NA       100              NA    NA</span></span>
<span><span class="co">#&gt; 7                        3       NA        50              NA    NA</span></span>
<span><span class="co">#&gt; 8                        3       25        NA              NA    NA</span></span>
<span><span class="co">#&gt; 9                        6       NA        20             100    NA</span></span>
<span><span class="co">#&gt; 10                       6       NA       100              NA    NA</span></span>
<span><span class="co">#&gt;    product_category</span></span>
<span><span class="co">#&gt; 1                NA</span></span>
<span><span class="co">#&gt; 2                NA</span></span>
<span><span class="co">#&gt; 3                NA</span></span>
<span><span class="co">#&gt; 4                NA</span></span>
<span><span class="co">#&gt; 5                NA</span></span>
<span><span class="co">#&gt; 6                NA</span></span>
<span><span class="co">#&gt; 7                NA</span></span>
<span><span class="co">#&gt; 8                NA</span></span>
<span><span class="co">#&gt; 9                NA</span></span>
<span><span class="co">#&gt; 10               NA</span></span></code></pre></div>
<p>This then allows the data to be processed in bulk without triggerring
errors related to missing data.</p>
</div>
<div class="section level2">
<h2 id="data-validity">Data validity<a class="anchor" aria-label="anchor" href="#data-validity"></a>
</h2>
<p>Please see the article on <a href="../articles/preprocessing.html">Preprocessing input data</a> to
see advice on how to check whether parameters are valid and within the
range expected, and to fix any typos in the dataset.</p>
</div>
<div class="section level2">
<h2 id="missing-data">Missing data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h2>
<p>Certain parameters are only required for certain product types, so we
have included some functions to check if the necessary parameters are
present for each specific product.</p>
<div class="section level3">
<h3 id="find-out-what-data-is-missing">Find out what data is missing<a class="anchor" aria-label="anchor" href="#find-out-what-data-is-missing"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">report_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ReqParamCheck.html">ReqParamCheck</a></span><span class="op">(</span><span class="va">incomplete_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Please note that the following parameters are optional and are not checked here:"</span></span>
<span><span class="co">#&gt; [1] "name"             "brand"            "product_category"</span></span>
<span><span class="co">#&gt; [1] "Please note that the following parameters have automatically applied defaults if missing and are not checked by this function:"</span></span>
<span><span class="co">#&gt; [1] "drink_format" "food_type"    "drink_type"  </span></span>
<span><span class="co">#&gt; [1] "If you wish to check the presence of these parameters and record when defaults are used,"</span></span>
<span><span class="co">#&gt; [1] "please see the `AutoDefaultParamCheck()` and `AutoDefaultParamNote()` functions"</span></span>
<span><span class="co">#&gt; [1] "Please see the `SaveReport()` function to output a csv version of this report table."</span></span></code></pre></div>
<p>We can transpose and print this table to see how many rows are
missing values for each parameter:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">report_table</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         [,1]     </span></span>
<span><span class="co">#&gt; name                    NA       </span></span>
<span><span class="co">#&gt; brand                   NA       </span></span>
<span><span class="co">#&gt; product_category        NA       </span></span>
<span><span class="co">#&gt; product_type            integer,0</span></span>
<span><span class="co">#&gt; food_type               NA       </span></span>
<span><span class="co">#&gt; drink_format            NA       </span></span>
<span><span class="co">#&gt; drink_type              NA       </span></span>
<span><span class="co">#&gt; nutrition_info          integer,0</span></span>
<span><span class="co">#&gt; energy_measurement_kj   integer,0</span></span>
<span><span class="co">#&gt; energy_measurement_kcal NA       </span></span>
<span><span class="co">#&gt; sugar_measurement_g     integer,3</span></span>
<span><span class="co">#&gt; satfat_measurement_g    integer,0</span></span>
<span><span class="co">#&gt; salt_measurement_g      integer,0</span></span>
<span><span class="co">#&gt; sodium_measurement_mg   NA       </span></span>
<span><span class="co">#&gt; fibre_measurement_nsp   integer,0</span></span>
<span><span class="co">#&gt; fibre_measurement_aoac  NA       </span></span>
<span><span class="co">#&gt; protein_measurement_g   integer,0</span></span>
<span><span class="co">#&gt; fvn_measurement_percent integer,0</span></span>
<span><span class="co">#&gt; weight_g                integer,0</span></span>
<span><span class="co">#&gt; volume_ml               NA       </span></span>
<span><span class="co">#&gt; volume_water_ml         integer,0</span></span></code></pre></div>
<p>In addition, there are certain parameters that have automatically
assigned defaults if they are missing
(<code>"drink_format", "food_type", "drink_type"</code>). You can also
check if these parameters are missing using the
<code><a href="../reference/AutoDefaultParamCheck.html">AutoDefaultParamCheck()</a></code> function. This adds the indices of
rows missing these values to the report dataframe object:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">report_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AutoDefaultParamCheck.html">AutoDefaultParamCheck</a></span><span class="op">(</span><span class="va">incomplete_data</span>, <span class="va">report_table</span><span class="op">)</span></span></code></pre></div>
<p>These “automatic defaults” can be recorded in the dataframe of
product data by using the <code><a href="../reference/AutoDefaultParamNote.html">AutoDefaultParamNote()</a></code> function,
in the <code>default_params_used</code> column:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">incomplete_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AutoDefaultParamNote.html">AutoDefaultParamNote</a></span><span class="op">(</span><span class="va">incomplete_data</span>, <span class="va">report_table</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Checking drink_format"</span></span>
<span><span class="co">#&gt; [1] "Checking food_type"</span></span>
<span><span class="co">#&gt; [1] "Checking drink_type"</span></span>
<span></span>
<span><span class="va">incomplete_data</span></span>
<span><span class="co">#&gt;                  name brand product_category product_type food_type</span></span>
<span><span class="co">#&gt; 1              lembas    NA               NA         Food          </span></span>
<span><span class="co">#&gt; 2     zeno's icecream    NA               NA         Food Ice cream</span></span>
<span><span class="co">#&gt; 3         mystic rush    NA               NA        Drink          </span></span>
<span><span class="co">#&gt; 4  delta ringer drink    NA               NA        Drink          </span></span>
<span><span class="co">#&gt; 5        welter water    NA               NA        Drink          </span></span>
<span><span class="co">#&gt; 6       janus's drink    NA               NA         Food          </span></span>
<span><span class="co">#&gt; 7   beta ringer drink    NA               NA        Drink          </span></span>
<span><span class="co">#&gt; 8   zeta ringer drink    NA               NA        Drink          </span></span>
<span><span class="co">#&gt; 9   heavyweight water    NA               NA        Drink          </span></span>
<span><span class="co">#&gt; 10       bantam water    NA               NA        Drink          </span></span>
<span><span class="co">#&gt;    drink_format             drink_type                     nutrition_info</span></span>
<span><span class="co">#&gt; 1                                                                        </span></span>
<span><span class="co">#&gt; 2                                                                        </span></span>
<span><span class="co">#&gt; 3         Ready Carbonated/juice drink                                   </span></span>
<span><span class="co">#&gt; 4      Powdered                            Preparation instructions given</span></span>
<span><span class="co">#&gt; 5       Cordial                                               As consumed</span></span>
<span><span class="co">#&gt; 6                                                                        </span></span>
<span><span class="co">#&gt; 7      Powdered                                               As consumed</span></span>
<span><span class="co">#&gt; 8      Powdered                        Preparation instructions not given</span></span>
<span><span class="co">#&gt; 9       Cordial                            Preparation instructions given</span></span>
<span><span class="co">#&gt; 10      Cordial                        Preparation instructions not given</span></span>
<span><span class="co">#&gt;    energy_measurement_kj energy_measurement_kcal sugar_measurement_g</span></span>
<span><span class="co">#&gt; 1                    266                      NA                    </span></span>
<span><span class="co">#&gt; 2                     NA                      24                    </span></span>
<span><span class="co">#&gt; 3                     NA                     194                  11</span></span>
<span><span class="co">#&gt; 4                    188                      NA                    </span></span>
<span><span class="co">#&gt; 5                     NA                     205                  19</span></span>
<span><span class="co">#&gt; 6                     NA                      24                  21</span></span>
<span><span class="co">#&gt; 7                    188                      NA                  15</span></span>
<span><span class="co">#&gt; 8                    188                      NA                  15</span></span>
<span><span class="co">#&gt; 9                     NA                     205                  19</span></span>
<span><span class="co">#&gt; 10                    NA                     205                  19</span></span>
<span><span class="co">#&gt;    satfat_measurement_g salt_measurement_g sodium_measurement_mg</span></span>
<span><span class="co">#&gt; 1                     3                 NA                   0.6</span></span>
<span><span class="co">#&gt; 2                    11               0.08                    NA</span></span>
<span><span class="co">#&gt; 3                     0                 NA                 100.0</span></span>
<span><span class="co">#&gt; 4                     0                 NA                 100.0</span></span>
<span><span class="co">#&gt; 5                     0               0.10                    NA</span></span>
<span><span class="co">#&gt; 6                    11               0.08                    NA</span></span>
<span><span class="co">#&gt; 7                     0                 NA                 100.0</span></span>
<span><span class="co">#&gt; 8                     0                 NA                 100.0</span></span>
<span><span class="co">#&gt; 9                     0               0.10                    NA</span></span>
<span><span class="co">#&gt; 10                    0               0.10                    NA</span></span>
<span><span class="co">#&gt;    fibre_measurement_nsp fibre_measurement_aoac protein_measurement_g</span></span>
<span><span class="co">#&gt; 1                      3                     NA                   7.0</span></span>
<span><span class="co">#&gt; 2                     NA                    0.7                   3.5</span></span>
<span><span class="co">#&gt; 3                     NA                    0.0                   0.0</span></span>
<span><span class="co">#&gt; 4                     NA                    0.0                   0.5</span></span>
<span><span class="co">#&gt; 5                     NA                    0.0                   0.1</span></span>
<span><span class="co">#&gt; 6                     NA                    0.7                   3.5</span></span>
<span><span class="co">#&gt; 7                     NA                    0.0                   0.5</span></span>
<span><span class="co">#&gt; 8                     NA                    0.0                   0.5</span></span>
<span><span class="co">#&gt; 9                     NA                    0.0                   0.1</span></span>
<span><span class="co">#&gt; 10                    NA                    0.0                   0.1</span></span>
<span><span class="co">#&gt;    fvn_measurement_percent weight_g volume_ml volume_water_ml</span></span>
<span><span class="co">#&gt; 1                        0      100        NA              NA</span></span>
<span><span class="co">#&gt; 2                        0       NA       100              NA</span></span>
<span><span class="co">#&gt; 3                        0       NA       100              NA</span></span>
<span><span class="co">#&gt; 4                        3       25        NA             100</span></span>
<span><span class="co">#&gt; 5                        6       NA       100              NA</span></span>
<span><span class="co">#&gt; 6                        0       NA       100              NA</span></span>
<span><span class="co">#&gt; 7                        3       NA        50              NA</span></span>
<span><span class="co">#&gt; 8                        3       25        NA              NA</span></span>
<span><span class="co">#&gt; 9                        6       NA        20             100</span></span>
<span><span class="co">#&gt; 10                       6       NA       100              NA</span></span>
<span><span class="co">#&gt;    default_params_used</span></span>
<span><span class="co">#&gt; 1            food_type</span></span>
<span><span class="co">#&gt; 2                 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3                 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4           drink_type</span></span>
<span><span class="co">#&gt; 5           drink_type</span></span>
<span><span class="co">#&gt; 6            food_type</span></span>
<span><span class="co">#&gt; 7           drink_type</span></span>
<span><span class="co">#&gt; 8           drink_type</span></span>
<span><span class="co">#&gt; 9           drink_type</span></span>
<span><span class="co">#&gt; 10          drink_type</span></span></code></pre></div>
<p>We can use the report generated by <code><a href="../reference/ReqParamCheck.html">ReqParamCheck()</a></code> and
<code><a href="../reference/AutoDefaultParamCheck.html">AutoDefaultParamCheck()</a></code> to discover what parameters are
missing in more detail. When we printed the transposed report table
above (using <code>t(report_table)</code>), we saw that some parameters
read <code>NA</code> - these are optional parameters that were not
checked. Some parameters read <code>integer, 0</code> meaning that these
parameters were checked, and no data is missing from product entries
where that parameter is required. Where data is missing,
<code>integer, NUM</code> is repeated with a non-zero value in place of
<code>NUM</code>, for example <code>sugar_measurement_g</code> reads
<code>integer, 3</code>. You can interogate which product entries are
missing data for <code>sugar_measurement_g</code> using the double
bracket notation:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">report_table</span><span class="op">$</span><span class="va">sugar_measurement_g</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 1 2 4</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fill-missing-data">Fill missing data<a class="anchor" aria-label="anchor" href="#fill-missing-data"></a>
</h3>
<p>We can enter data for <code>sugar_measurement_g</code> in products
with the indices <code>1 2 4</code> using the
<code><a href="../reference/ManualParamUpdate.html">ManualParamUpdate()</a></code> function. This function takes the
following arguments: <code>data_frame</code>, the product data.frame
object being analysed, in this case <code>incomplete_data</code>;
<code>parameter_name</code> - in this case
<code>"sugar_measurement_g"</code>; <code>index_list</code> - these can
be supplied manually or from the report as shown above;
<code>value</code> - the value to set the parameter to for these rows.
We are going to use an unrealistically high value of <code>100.0</code>
in order to clearly see where this has been applied.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">updated_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ManualParamUpdate.html">ManualParamUpdate</a></span><span class="op">(</span></span>
<span>  <span class="va">incomplete_data</span>,</span>
<span>  <span class="st">"sugar_measurement_g"</span>,</span>
<span>  <span class="va">report_table</span><span class="op">$</span><span class="va">sugar_measurement_g</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  <span class="fl">100.0</span><span class="op">)</span></span></code></pre></div>
<p>Where values are required to be numeric, we can coerce the values to
a numeric type:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">updated_data</span><span class="op">$</span><span class="va">sugar_measurement_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">updated_data</span><span class="op">$</span><span class="va">sugar_measurement_g</span><span class="op">)</span></span></code></pre></div>
<p>We can see the updated <code>sugar_measurement_g</code> values in our
dataframe, before and after the coercion:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Update sugar values:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">updated_data</span><span class="op">$</span><span class="va">sugar_measurement_g</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "100" "100" "11"  "100" "19"  "21"  "15"  "15"  "19"  "19"</span></span>
<span></span>
<span><span class="va">updated_data</span><span class="op">$</span><span class="va">sugar_measurement_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">updated_data</span><span class="op">$</span><span class="va">sugar_measurement_g</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Record of where parameters have been manually edited/applied:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">updated_data</span><span class="op">$</span><span class="va">manual_params_used</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "sugar_measurement_g" "sugar_measurement_g" NA                   </span></span>
<span><span class="co">#&gt;  [4] "sugar_measurement_g" NA                    NA                   </span></span>
<span><span class="co">#&gt;  [7] NA                    NA                    NA                   </span></span>
<span><span class="co">#&gt; [10] NA</span></span></code></pre></div>
<p>This updated dataframe can then be used in the analysis workflow
examples given in this documentation:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="va">updated_data_results</span> <span class="op">&lt;-</span> <span class="va">updated_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> sg <span class="op">=</span> <span class="fu"><a href="../reference/SGConverter.html">SGConverter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pick.html" class="external-link">pick</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>test <span class="op">=</span> <span class="fu"><a href="../reference/NPMScore.html">NPMScore</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pick.html" class="external-link">pick</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, sg_adjusted_label<span class="op">=</span><span class="st">"sg"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>assess <span class="op">=</span> <span class="fu"><a href="../reference/NPMAssess.html">NPMAssess</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pick.html" class="external-link">pick</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">assess</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">energy_score</span>, <span class="va">sugar_score</span>, <span class="va">salt_score</span>, <span class="va">fvn_score</span>,</span>
<span>  <span class="va">protein_score</span>, <span class="va">satfat_score</span>, <span class="va">fibre_score</span>, <span class="va">NPM_score</span>, <span class="va">NPM_assessment</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="checking-for-incorrect-data">Checking for incorrect data<a class="anchor" aria-label="anchor" href="#checking-for-incorrect-data"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alex Coleman, Vicki Jenneson, Maeve Murphy Quinlan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
